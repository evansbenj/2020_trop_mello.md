# Assembly Statistics

I'm using GAAS for this.

Need to install perl modules to make this work (the -i is needed to allow local instal):
```
eval "$(perl -I$HOME/perl5/lib/perl5 -Mlocal::lib)"
cpan -i Statistics::R
```

```
#!/bin/sh
#SBATCH --job-name=gaas
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --time=24:00:00
#SBATCH --mem=2gb
#SBATCH --output=gaas.%J.out
#SBATCH --error=gaas.%J.err
#SBATCH --account=def-ben

module load StdEnv/2020 perl/5.30.2
module load StdEnv/2020 bioperl/1.7.7
module load StdEnv/2020 r/4.1.2

/home/ben/projects/rrg-ben/ben/2021_Austin_XB_genome/Austin_genome/GAAS/bin/gaas_fasta_statistics.pl -f /home/b
en/projects/rrg-ben/ben/2020_mellotrop_RNA/primary.genome.scf.fasta
```
```
/home/ben/projects/rrg-ben/ben/2021_Austin_XB_genome/Austin_genome/GAAS/bin/gaas_fasta_statistics.pl -f /home/ben/projects/rrg-ben/ben/2020_mellotrop_RNA/primary.genome.scf.fasta
```

# Stats

* this is for the assembly that uses  
  * The Germany assembly combined with the pacbio seqs (an error reading this file was fixed - the whole path was needed)
  * the 10kb mate pair data
  * the 6kb mate pair data
  * the 180bp_PE_2nd_library
  * This is the best assembly so far because the N50 and N90 are (mostly) highest and the L50 and L90 are lowest!

This is from the assembly:
```
N50 40311
Sequence 1211377572
Average 7204.23
E-size 54239.1
Count 168148
````
This is from GAAS:
```
--------------------------------------------------------------------------------
|                           primary.genome.scf.fasta                           |
|                Analysis launched the 11/27/2023 at 10h23m00s                 |
|------------------------------------------------------------------------------|
| Nb of sequences                                         |       168148       |
|------------------------------------------------------------------------------|
| Nb of sequences >1kb                                    |        92229       |
|------------------------------------------------------------------------------|
| Nb of sequences >10kb                                   |        24919       |
|------------------------------------------------------------------------------|
| Nb of nucleotides (counting Ns)                         |     1211377572     |
|------------------------------------------------------------------------------|
| Nb of nucleotides U                                     |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences with U nucleotides                      |          0         |
|------------------------------------------------------------------------------|
| Nb of IUPAC nucleotides                                 |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences with IUPAC nucleotides                  |          0         |
|------------------------------------------------------------------------------|
| Nb of Ns                                                |      19025696      |
|------------------------------------------------------------------------------|
| Nb of internal N-regions (possibly links between contigs)|       72816       |
|------------------------------------------------------------------------------|
| Nb of long internal N-regions >10000                    |                    |
| /!\ This is problematic for Genemark                    |        143         |
|------------------------------------------------------------------------------|
| Nb of pure (only) N sequences                           |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences that begin or end with Ns               |          0         |
|------------------------------------------------------------------------------|
| GC-content (%)                                          |        39.1        |
|------------------------------------------------------------------------------|
| GC-content not counting Ns(%)                           |        39.8        |
|------------------------------------------------------------------------------|
| Nb of sequences with lowercase nucleotides              |        6527        |
|------------------------------------------------------------------------------|
| Nb of lowercase nucleotides                             |      116764858     |
|------------------------------------------------------------------------------|
| N50                                                     |        40311       |
|------------------------------------------------------------------------------|
| L50                                                     |        8107        |
|------------------------------------------------------------------------------|
| N90                                                     |        3139        |
|------------------------------------------------------------------------------|
| L90                                                     |        48573       |
|------------------------------------------------------------------------------|
```

```
/home/ben/projects/rrg-ben/ben/2020_mellotrop_RNA/assembly_pacbio_supernova_combined_all_matepair/primary.genome.scf.fasta 
```
* this is for the assembly that uses  
  * The Germany assembly combined without the pacbio seqs (due to an error reading this file - the whole path was needed)
  * the 10kb mate pair data
  * the 6kb mate pair data
  * the 180bp_PE_2nd_library
  * This is the best assembly so far because the N50 and N90 are highest and the L50 and L90 are lowest!

```
--------------------------------------------------------------------------------
|                           primary.genome.scf.fasta                           |
|                Analysis launched the 08/01/2023 at 10h48m26s                 |
|------------------------------------------------------------------------------|
| Nb of sequences                                         |       220156       |
|------------------------------------------------------------------------------|
| Nb of sequences >1kb                                    |       119180       |
|------------------------------------------------------------------------------|
| Nb of sequences >10kb                                   |        27909       |
|------------------------------------------------------------------------------|
| Nb of nucleotides (counting Ns)                         |     1129195848     |
|------------------------------------------------------------------------------|
| Nb of nucleotides U                                     |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences with U nucleotides                      |          0         |
|------------------------------------------------------------------------------|
| Nb of IUPAC nucleotides                                 |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences with IUPAC nucleotides                  |          0         |
|------------------------------------------------------------------------------|
| Nb of Ns                                                |      7235500       |
|------------------------------------------------------------------------------|
| Nb of internal N-regions (possibly links between contigs)|       72355       |
|------------------------------------------------------------------------------|
| Nb of long internal N-regions >10000                    |                    |
| /!\ This is problematic for Genemark                    |          0         |
|------------------------------------------------------------------------------|
| Nb of pure (only) N sequences                           |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences that begin or end with Ns               |          0         |
|------------------------------------------------------------------------------|
| GC-content (%)                                          |        39.5        |
|------------------------------------------------------------------------------|
| GC-content not counting Ns(%)                           |        39.7        |
|------------------------------------------------------------------------------|
| Nb of sequences with lowercase nucleotides              |          0         |
|------------------------------------------------------------------------------|
| Nb of lowercase nucleotides                             |          0         |
|------------------------------------------------------------------------------|
| N50                                                     |        22039       |
|------------------------------------------------------------------------------|
| L50                                                     |        13284       |
|------------------------------------------------------------------------------|
| N90                                                     |        1981        |
|------------------------------------------------------------------------------|
| L90                                                     |        80881       |
|------------------------------------------------------------------------------|
```

# Stats
* this is for the assembly that uses  
  * The Germany assembly combined without the pacbio seqs (due to an error reading this file - the whole path was needed)
  * the 10kb mate pair data
  * the 180bp_PE_2nd_library
```
--------------------------------------------------------------------------------
|                           primary.genome.scf.fasta                           |
|                Analysis launched the 07/17/2023 at 07h22m44s                 |
|------------------------------------------------------------------------------|
| Nb of sequences                                         |       220732       |
|------------------------------------------------------------------------------|
| Nb of sequences >1kb                                    |       123078       |
|------------------------------------------------------------------------------|
| Nb of sequences >10kb                                   |        27360       |
|------------------------------------------------------------------------------|
| Nb of nucleotides (counting Ns)                         |     1107259514     |
|------------------------------------------------------------------------------|
| Nb of nucleotides U                                     |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences with U nucleotides                      |          0         |
|------------------------------------------------------------------------------|
| Nb of IUPAC nucleotides                                 |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences with IUPAC nucleotides                  |          0         |
|------------------------------------------------------------------------------|
| Nb of Ns                                                |      6092200       |
|------------------------------------------------------------------------------|
| Nb of internal N-regions (possibly links between contigs)|       60922       |
|------------------------------------------------------------------------------|
| Nb of long internal N-regions >10000                    |                    |
| /!\ This is problematic for Genemark                    |          0         |
|------------------------------------------------------------------------------|
| Nb of pure (only) N sequences                           |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences that begin or end with Ns               |          0         |
|------------------------------------------------------------------------------|
| GC-content (%)                                          |        39.5        |
|------------------------------------------------------------------------------|
| GC-content not counting Ns(%)                           |        39.7        |
|------------------------------------------------------------------------------|
| Nb of sequences with lowercase nucleotides              |          0         |
|------------------------------------------------------------------------------|
| Nb of lowercase nucleotides                             |          0         |
|------------------------------------------------------------------------------|
| N50                                                     |        20513       |
|------------------------------------------------------------------------------|
| L50                                                     |        13808       |
|------------------------------------------------------------------------------|
| N90                                                     |        1920        |
|------------------------------------------------------------------------------|
| L90                                                     |        84841       |
|------------------------------------------------------------------------------|

```

* this is for the assembly that uses  
  * The Germany data
  * the 10kb mate pair data
  * without the pacbio seqs (due to an error reading this file - the whole path was needed)

```
--------------------------------------------------------------------------------
|                           primary.genome.scf.fasta                           |
|                Analysis launched the 05/18/2023 at 16h43m54s                 |
|------------------------------------------------------------------------------|
| Nb of sequences                                         |       195542       |
|------------------------------------------------------------------------------|
| Nb of sequences >1kb                                    |       120067       |
|------------------------------------------------------------------------------|
| Nb of sequences >10kb                                   |        23988       |
|------------------------------------------------------------------------------|
| Nb of nucleotides (counting Ns)                         |     1520216185     |
|------------------------------------------------------------------------------|
| Nb of nucleotides U                                     |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences with U nucleotides                      |          0         |
|------------------------------------------------------------------------------|
| Nb of IUPAC nucleotides                                 |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences with IUPAC nucleotides                  |          0         |
|------------------------------------------------------------------------------|
| Nb of Ns                                                |      19106800      |
|------------------------------------------------------------------------------|
| Nb of internal N-regions (possibly links between contigs)|      191068       |
|------------------------------------------------------------------------------|
| Nb of long internal N-regions >10000                    |                    |
| /!\ This is problematic for Genemark                    |          0         |
|------------------------------------------------------------------------------|
| Nb of pure (only) N sequences                           |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences that begin or end with Ns               |          0         |
|------------------------------------------------------------------------------|
| GC-content (%)                                          |        39.2        |
|------------------------------------------------------------------------------|
| GC-content not counting Ns(%)                           |        39.7        |
|------------------------------------------------------------------------------|
| Nb of sequences with lowercase nucleotides              |         20         |
|------------------------------------------------------------------------------|
| Nb of lowercase nucleotides                             |        33395       |
|------------------------------------------------------------------------------|
| N50                                                     |        59273       |
|------------------------------------------------------------------------------|
| L50                                                     |        6630        |
|------------------------------------------------------------------------------|
| N90                                                     |        2687        |
|------------------------------------------------------------------------------|
| L90                                                     |        54754       |
|------------------------------------------------------------------------------|
```
The output file also included this information (which mostly overlaps with the above):
```
N50 59273
Sequence 1520216185
Average 7774.37
E-size 92706.5
Count 195542
```
* E-size is explained here: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4055594/


* this is for the assembly that uses  
  * The Germany assembly combined without the pacbio seqs (due to an error reading this file - the whole path was needed)
  * the 180bp_PE_2nd_library


```
--------------------------------------------------------------------------------
|                           primary.genome.scf.fasta                           |
|                Analysis launched the 12/17/2023 at 14h42m01s                 |
|------------------------------------------------------------------------------|
| Nb of sequences                                         |        65880       |
|------------------------------------------------------------------------------|
| Nb of sequences >1kb                                    |        59113       |
|------------------------------------------------------------------------------|
| Nb of sequences >10kb                                   |        11086       |
|------------------------------------------------------------------------------|
| Nb of nucleotides (counting Ns)                         |      582002592     |
|------------------------------------------------------------------------------|
| Nb of nucleotides U                                     |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences with U nucleotides                      |          0         |
|------------------------------------------------------------------------------|
| Nb of IUPAC nucleotides                                 |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences with IUPAC nucleotides                  |          0         |
|------------------------------------------------------------------------------|
| Nb of Ns                                                |      12488400      |
|------------------------------------------------------------------------------|
| Nb of internal N-regions (possibly links between contigs)|        3864       |
|------------------------------------------------------------------------------|
| Nb of long internal N-regions >10000                    |                    |
| /!\ This is problematic for Genemark                    |        158         |
|------------------------------------------------------------------------------|
| Nb of pure (only) N sequences                           |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences that begin or end with Ns               |          0         |
|------------------------------------------------------------------------------|
| GC-content (%)                                          |        38.2        |
|------------------------------------------------------------------------------|
| GC-content not counting Ns(%)                           |        39.1        |
|------------------------------------------------------------------------------|
| Nb of sequences with lowercase nucleotides              |        6155        |
|------------------------------------------------------------------------------|
| Nb of lowercase nucleotides                             |      176056866     |
|------------------------------------------------------------------------------|
| N50                                                     |        30962       |
|------------------------------------------------------------------------------|
| L50                                                     |        4039        |
|------------------------------------------------------------------------------|
| N90                                                     |        3282        |
|------------------------------------------------------------------------------|
| L90                                                     |        31740       |
|------------------------------------------------------------------------------|
```

```
N50 30962
Sequence 582002592
Average 8834.28
E-size 55232.6
Count 65880
```

# Germany Supernova genome stats
* these are worse in all respects compared to the Masurca assembly which included PacBio seqs because the N50 and N90 are lower and the L50 and L90 are higher in the Germany genome compared to the masurca genome
```
--------------------------------------------------------------------------------
|                        Super_NovaXeno_mega_gt200.fasta                       |
|                Analysis launched the 05/19/2023 at 11h49m55s                 |
|------------------------------------------------------------------------------|
| Nb of sequences                                         |       777284       |
|------------------------------------------------------------------------------|
| Nb of sequences >1kb                                    |       358046       |
|------------------------------------------------------------------------------|
| Nb of sequences >10kb                                   |        41618       |
|------------------------------------------------------------------------------|
| Nb of nucleotides (counting Ns)                         |     2860792056     |
|------------------------------------------------------------------------------|
| Nb of nucleotides U                                     |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences with U nucleotides                      |          0         |
|------------------------------------------------------------------------------|
| Nb of IUPAC nucleotides                                 |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences with IUPAC nucleotides                  |          0         |
|------------------------------------------------------------------------------|
| Nb of Ns                                                |      133949310     |
|------------------------------------------------------------------------------|
| Nb of internal N-regions (possibly links between contigs)|      100022       |
|------------------------------------------------------------------------------|
| Nb of long internal N-regions >10000                    |                    |
| /!\ This is problematic for Genemark                    |        1475        |
|------------------------------------------------------------------------------|
| Nb of pure (only) N sequences                           |          4         |
|------------------------------------------------------------------------------|
| Nb of sequences that begin or end with Ns               |         77         |
|------------------------------------------------------------------------------|
| GC-content (%)                                          |        38.0        |
|------------------------------------------------------------------------------|
| GC-content not counting Ns(%)                           |        39.9        |
|------------------------------------------------------------------------------|
| Nb of sequences with lowercase nucleotides              |          0         |
|------------------------------------------------------------------------------|
| Nb of lowercase nucleotides                             |          0         |
|------------------------------------------------------------------------------|
| N50                                                     |        19103       |
|------------------------------------------------------------------------------|
| L50                                                     |        22095       |
|------------------------------------------------------------------------------|
| N90                                                     |        1362        |
|------------------------------------------------------------------------------|
| L90                                                     |       290355       |
|------------------------------------------------------------------------------|
```

# DBG2OLC Stats

* these are worse in some respects compared to the Masurca assembly which included PacBio seqs. The N50 but not the N90 is lower; the L50 and L90 are lower in the DBG2OLC genome compared to the masurca genome. In the DBG2OLC genome the N90 is higher which suggests the small contigs tend to be large.

--------------------------------------------------------------------------------
|                             final_assembly.fasta                             |
|                Analysis launched the 05/27/2023 at 06h34m02s                 |
|------------------------------------------------------------------------------|
| Nb of sequences                                         |        6468        |
|------------------------------------------------------------------------------|
| Nb of sequences >1kb                                    |        6462        |
|------------------------------------------------------------------------------|
| Nb of sequences >10kb                                   |        3494        |
|------------------------------------------------------------------------------|
| Nb of nucleotides (counting Ns)                         |      75805822      |
|------------------------------------------------------------------------------|
| Nb of nucleotides U                                     |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences with U nucleotides                      |          0         |
|------------------------------------------------------------------------------|
| Nb of IUPAC nucleotides                                 |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences with IUPAC nucleotides                  |          0         |
|------------------------------------------------------------------------------|
| Nb of Ns                                                |         13         |
|------------------------------------------------------------------------------|
| Nb of internal N-regions (possibly links between contigs)|         2         |
|------------------------------------------------------------------------------|
| Nb of long internal N-regions >10000                    |                    |
| /!\ This is problematic for Genemark                    |          0         |
|------------------------------------------------------------------------------|
| Nb of pure (only) N sequences                           |          0         |
|------------------------------------------------------------------------------|
| Nb of sequences that begin or end with Ns               |          0         |
|------------------------------------------------------------------------------|
| GC-content (%)                                          |        43.9        |
|------------------------------------------------------------------------------|
| GC-content not counting Ns(%)                           |        43.9        |
|------------------------------------------------------------------------------|
| Nb of sequences with lowercase nucleotides              |          0         |
|------------------------------------------------------------------------------|
| Nb of lowercase nucleotides                             |          0         |
|------------------------------------------------------------------------------|
| N50                                                     |        13913       |
|------------------------------------------------------------------------------|
| L50                                                     |        2006        |
|------------------------------------------------------------------------------|
| N90                                                     |        7008        |
|------------------------------------------------------------------------------|
| L90                                                     |        4976        |
|------------------------------------------------------------------------------|
